FROM ubuntu:mantic-20240216


RUN apt-get update -y --no-install-recommends  \
    && apt-get install nginx -y --no-install-recommends 

COPY ./03_Proactive_vulnerability_mitigation/server/default /etc/nginx/sites-available/default
COPY ./03_Proactive_vulnerability_mitigation/server/html /usr/share/nginx/html

RUN useradd --user-group --system --create-home --no-log-init dev
RUN chown -R dev:dev /usr/share/nginx/html 
RUN chown -R dev:dev /var/lib/nginx
RUN chown -R dev:dev /var/log/nginx
RUN chown dev:dev /var/run

EXPOSE 80/tcp
USER dev

CMD ["/usr/sbin/nginx", "-g", "daemon off;"]